# .mise.toml - Development Environment Configuration
[tools]
java = "openjdk-8"
maven = "1.8"
node = "18"  # Required for some tools
python = "3.11"  # Required for AWS CLI

[plugins]
# Custom plugins for tools not in core mise
vagrant = "https://github.com/asdf-community/asdf-vagrant.git"
docker = "https://github.com/mise-plugins/mise-docker.git"

[env]
JAVA_HOME = "{{exec(command='mise where java')}}"
MAVEN_HOME = "{{exec(command='mise where maven')}}"
MAVEN_OPTS = "-Xmx1024m -XX:MaxPermSize=256m"
PATH = [
  "{{env.JAVA_HOME}}/bin",
  "{{env.MAVEN_HOME}}/bin",
  "{{env.PATH}}"
]

[tasks.setup]
description = "Setup development environment"
run = [
  "echo '🚀 Setting up development environment...'",
  "mise install",
  "echo '✅ All tools installed!'",
  "mise exec -- java -version",
  "mise exec -- mvn -version",
  "mise exec -- git --version",
  "echo '🎉 Environment ready!'"
]

[tasks.status]
description = "Check all tool versions"
run = [
  "echo '=== Development Environment Status ==='",
  "echo '📋 Installed Tools:'",
  "mise list",
  "echo ''",
  "echo '☕ Java:'",
  "mise exec -- java -version 2>&1 | head -1 || echo 'Not installed'",
  "echo ''",
  "echo '📦 Maven:'", 
  "mise exec -- mvn -version 2>&1 | head -1 || echo 'Not installed'",
  "echo ''",
  "echo '🔧 Git:'",
  "git --version 2>&1 || echo 'Not installed'",
  "echo ''",
  "echo '🐳 Docker:'",
  "docker --version 2>&1 || echo 'Not installed/running'",
  "echo ''",
  "echo '📦 Vagrant:'",
  "vagrant --version 2>&1 || echo 'Not installed'",
  "echo ''",
  "echo '☁️ AWS CLI:'",
  "aws --version 2>&1 | head -1 || echo 'Not installed'",
  "echo '================================='"
]

[tasks.create-project]
description = "Create new Maven project"
run = [
  "echo '📁 Creating Maven project...'",
  "mise exec -- mvn archetype:generate -DgroupId=com.example.app -DartifactId=my-app -DarchetypeArtifactId=maven-archetype-quickstart -DinteractiveMode=false",
  "echo '✅ Project created: my-app/'"
]

[tasks.build]
description = "Build Maven project"
run = [
  "echo '🔨 Building project...'",
  "mise exec -- mvn clean compile"
]

[tasks.test]
description = "Run tests"
run = [
  "echo '🧪 Running tests...'",
  "mise exec -- mvn test"
]

[tasks.package]
description = "Package application"
run = [
  "echo '📦 Packaging application...'",
  "mise exec -- mvn package"
]

[tasks.docker-build]
description = "Build Docker image"
run = [
  "echo '🐳 Building Docker image...'",
  "docker build -t my-app:latest ."
]

[tasks.vagrant-up]
description = "Start Vagrant VM"
run = [
  "echo '🚀 Starting Vagrant VM...'",
  "vagrant up"
]

[tasks.vagrant-down]
description = "Stop Vagrant VM"  
run = [
  "echo '🛑 Stopping Vagrant VM...'",
  "vagrant halt"
]

[tasks.aws-setup]
description = "Configure AWS CLI"
run = [
  "echo '☁️ Configuring AWS CLI...'",
  "aws configure"
]

[tasks.dev-env]
description = "Show development environment info"
run = [
  "echo '🏗️  Development Environment'",
  "echo '=========================='",
  "echo 'Project: {{cwd()}}'",
  "echo 'Java Home: $JAVA_HOME'",
  "echo 'Maven Home: $MAVEN_HOME'",
  "echo ''",
  "echo '📋 Available Tasks:'",
  "mise tasks",
  "echo ''",
  "echo '🔧 Available Tools:'",
  "mise ls",
]
