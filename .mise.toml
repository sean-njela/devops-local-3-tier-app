# .mise.toml - Development Environment Configuration
[tools]
java = "openjdk-8"
maven = "1.8"
node = "18"  # Required for some tools
python = "3.11"  # Required for AWS CLI

[plugins]
# Custom plugins for tools not in core mise
vagrant = "https://github.com/asdf-community/asdf-vagrant.git"
docker = "https://github.com/mise-plugins/mise-docker.git"

[env]
JAVA_HOME = "{{exec(command='mise where java')}}"
MAVEN_HOME = "{{exec(command='mise where maven')}}"
MAVEN_OPTS = "-Xmx1024m -XX:MaxPermSize=256m"
PATH = [
  "{{env.JAVA_HOME}}/bin",
  "{{env.MAVEN_HOME}}/bin",
  "{{env.PATH}}"
]

[tasks.setup]
description = "Setup development environment"
run = [
  "echo 'ğŸš€ Setting up development environment...'",
  "mise install",
  "echo 'âœ… All tools installed!'",
  "mise exec -- java -version",
  "mise exec -- mvn -version",
  "mise exec -- git --version",
  "echo 'ğŸ‰ Environment ready!'"
]

[tasks.status]
description = "Check all tool versions"
run = [
  "echo '=== Development Environment Status ==='",
  "echo 'ğŸ“‹ Installed Tools:'",
  "mise list",
  "echo ''",
  "echo 'â˜• Java:'",
  "mise exec -- java -version 2>&1 | head -1 || echo 'Not installed'",
  "echo ''",
  "echo 'ğŸ“¦ Maven:'", 
  "mise exec -- mvn -version 2>&1 | head -1 || echo 'Not installed'",
  "echo ''",
  "echo 'ğŸ”§ Git:'",
  "git --version 2>&1 || echo 'Not installed'",
  "echo ''",
  "echo 'ğŸ³ Docker:'",
  "docker --version 2>&1 || echo 'Not installed/running'",
  "echo ''",
  "echo 'ğŸ“¦ Vagrant:'",
  "vagrant --version 2>&1 || echo 'Not installed'",
  "echo ''",
  "echo 'â˜ï¸ AWS CLI:'",
  "aws --version 2>&1 | head -1 || echo 'Not installed'",
  "echo '================================='"
]

[tasks.create-project]
description = "Create new Maven project"
run = [
  "echo 'ğŸ“ Creating Maven project...'",
  "mise exec -- mvn archetype:generate -DgroupId=com.example.app -DartifactId=my-app -DarchetypeArtifactId=maven-archetype-quickstart -DinteractiveMode=false",
  "echo 'âœ… Project created: my-app/'"
]

[tasks.build]
description = "Build Maven project"
run = [
  "echo 'ğŸ”¨ Building project...'",
  "mise exec -- mvn clean compile"
]

[tasks.test]
description = "Run tests"
run = [
  "echo 'ğŸ§ª Running tests...'",
  "mise exec -- mvn test"
]

[tasks.package]
description = "Package application"
run = [
  "echo 'ğŸ“¦ Packaging application...'",
  "mise exec -- mvn package"
]

[tasks.docker-build]
description = "Build Docker image"
run = [
  "echo 'ğŸ³ Building Docker image...'",
  "docker build -t my-app:latest ."
]

[tasks.vagrant-up]
description = "Start Vagrant VM"
run = [
  "echo 'ğŸš€ Starting Vagrant VM...'",
  "vagrant up"
]

[tasks.vagrant-down]
description = "Stop Vagrant VM"  
run = [
  "echo 'ğŸ›‘ Stopping Vagrant VM...'",
  "vagrant halt"
]

[tasks.aws-setup]
description = "Configure AWS CLI"
run = [
  "echo 'â˜ï¸ Configuring AWS CLI...'",
  "aws configure"
]

[tasks.dev-env]
description = "Show development environment info"
run = [
  "echo 'ğŸ—ï¸  Development Environment'",
  "echo '=========================='",
  "echo 'Project: {{cwd()}}'",
  "echo 'Java Home: $JAVA_HOME'",
  "echo 'Maven Home: $MAVEN_HOME'",
  "echo ''",
  "echo 'ğŸ“‹ Available Tasks:'",
  "mise tasks",
  "echo ''",
  "echo 'ğŸ”§ Available Tools:'",
  "mise ls",
]
